@{

    
    //ViewBag.Title = "System";
    Layout = "~/Views/Shared/_ViewCo.cshtml";
    int rcdid = Nistec.Types.ToInt(Request["id"]);
    var userInfo = @Html.Raw(Json.Encode(ViewBag.UserInfo));

}

@section head {

    @Scripts.Render("~/bundles/jqx")
    @Scripts.Render("~/bundles/jqxgrid")
    <script type="text/javascript" src="~/jqwidgets/jqxdata.export.js"></script>
    <script type="text/javascript" src="~/Scripts/app/app-jqx-grid-1.0.js?ver=20180001"></script>

    <script type="text/javascript" src="~/Scripts/app/system/task-def.js?ver=20180001"></script>
    <script type="text/javascript" src="~/Scripts/app/app-wizard-1.0.js"></script>
    <link rel="stylesheet" href="~/Scripts/app/app-form.css" type="text/css" />
    <style type="text/css">
        input {
            direction: rtl;
            text-align: right;
        }

        /*.jqx-grid-cell {
            border: none;
        }

        .wiz-tab {
            display: none;
        }

            .wiz-tab.active {
                display: block;
            }*/
        #accordion {
        max-width:800px;
        }

    </style>

}


@section scripts {

    <script type="text/javascript">

    var wizard;
    var def;

    $(document).ready(function () {
        JSON.useDateParser();
        var theme = 'Arctic';
        var uinfo = JSON.parse('@userInfo');
        var taskid =@rcdid
        wizard = new app_wiztabs();
        wizard.displayStep(1);

        $("#accordion").accordion({ heightStyle: "content" });
        $("#jqxExp-1").jqxExpander({ width: '350px', rtl: true, expanded: false });

        def = new app_task_def('@rcdid', uinfo, true);

        app_tasks_comment.load(taskid, uinfo);
        app_tasks_assign.load(taskid, uinfo);
        app_tasks_timer.load(taskid, uinfo);

        $('#reset').on('click', function () {
            location.reload();
        });

        $('#fcSubmit').on('click', function (e) {
            e.preventDefault();
            def.doSubmit();
        });

        $('#fcClear').on('click', function (e) {
            $('#fcForm')[0].reset();
            $('#fcForm').jqxValidator('hide');
        });

        $('#fcCancel').on('click', function (e) {
            def.doCancel();
        });
        $('#fcComment').on('click', function (e) {
            def.doComment(taskid);
        });
        $('#fcAssign').on('click', function (e) {
            def.doAssign(taskid);
        });

    });
        function triggerCommentCompleted(data) {
            app_tasks_comment.end(data);
        }
        function goPartial(step) {
            wizard.displayStep(step);
        }
</script>
}

<div class="breadcrumbs">
</div>


<div class="global-view">
    <div id="wiz-container" class="container">

        <div id="wiz-1" class="wiz-tab active">
            <h3 class="rtl">איתור מנויים</h3>
            <div id="jqxWidget" style="margin: 0 auto; display: block; direction: rtl">
                <div id="fcBody">

                    <div id="accordion" class="tab-content1" dir="rtl">
                        <h3 id="hx-1">משימה</h3>
                        <div id="exp-1" style="padding:0;margin:0">
                            <div class="expander-entry" style="margin:10px">
                                <form class="fcForm" id="fcForm" method="post" action="/System/UpdateTask">
                                    <div style="direction: rtl; text-align: right">
                                        <input type="hidden" id="TaskId" name="TaskId" value="0" />
                                        <input type="hidden" id="AccountId" name="AccountId" value="" />
                                        <input type="hidden" id="Employee_Id" name="Employee_Id" value="" />
                                        <input type="hidden" id="Task_Parent" name="Task_Parent" value="" />
                                        <div style="height:5px"></div>
                                        <div id="tab-content" class="tab-content" dir="rtl">

                                            <div class="form-group">
                                                <div class="field">
                                                    סוג :
                                                </div>
                                                <div id="Task_Type" name="Task_Type"></div>
                                            </div>
                                            <div class="form-group">
                                                <div class="field">
                                                    נושא :
                                                </div>
                                                <input id="TaskSubject" name="TaskSubject" type="text" class="text-mid" />
                                            </div>
                                            <div class="form-group">
                                                <div class="field">
                                                    תוכן:
                                                </div>
                                                <textarea id="TaskBody" name="TaskBody" class="text-content"></textarea>
                                            </div>
                                            <div class="form-group">
                                                <div class="field">
                                                    סטאטוס :
                                                </div>
                                                <input id="Status" name="Status" type="text" class="text-mid" />
                                            </div>


                                            <div id="jqxExp-1">
                                                <div>
                                                    תאריכים
                                                </div>
                                                <div class="rtl" style="border:none">

                                                    <div class="form-group">
                                                        <div class="field">
                                                            נוצר ב:
                                                        </div>
                                                        <input id="CreatedDate" name="CreatedDate" type="text" readonly="readonly" class="text-mid" />
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="field">
                                                            תאריך לביצוע:
                                                        </div>
                                                        <div id="DueDate" name="DueDate"></div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="field">
                                                            מועד התחלה:
                                                        </div>
                                                        <input id="StartDate" name="StartDate" type="text" readonly="readonly" class="text-mid" />
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="field">
                                                            מועד סיום:
                                                        </div>
                                                        <input id="EndDate" name="EndDate" type="text" readonly="readonly" class="text-mid" />
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="field">
                                                            פרוייקט :
                                                        </div>
                                                        <div id="Project_Id" name="Project_Id"></div>
                                                    </div>
                                                    <div class="form-group">
                                                        <div class="field">
                                                            זמן משוער בימים :
                                                        </div>
                                                        <input id="TaskEstimateDays" name="TaskEstimateDays" type="number" class="text-mid" />
                                                    </div>
                                                    <div class="form-group">
                                                        <input type="checkbox" id="IsShare" name="IsShare" />&nbsp;<span>משותף</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                         <div style="height: 5px"></div>
                                         <div>
                                             <input id="fcSubmit" class="btn-default btn7 w-80" type="button" value="עדכון" />
                                                @*<input id="fcClear" class="btn-default btn7" type="button" value="ניקוי" />
                    <input id="fcCancel" class="btn-default btn7" type="button" value="ביטול" />
                    <input id="fcComment" class="btn-default btn7" type="button" value="הערות" />
                    <input id="fcAssign" class="btn-default btn7" type="button" value="היסטוריה" />*@
                                            </div>
                                        </div>
                                </form>
                            </div>
                        </div>
                        <h3>הערות</h3>
                        <div id="exp-2" style="padding:0;margin:0">
                            <div class="expander-entry">
                                <div class="grid-wrap rtl">
                                    <div>
                                        <a id="jqxgrid1-add" href="#" class="btn-default btn7">הוסף</a>
                                        <a id="jqxgrid1-edit" href="#" class="btn-default btn7">עריכה</a>
                                        <a id="jqxgrid1-remove" href="#" class="btn-default btn7">הסרה</a>
                                        <a id="jqxgrid1-refresh" href="#" class="btn-default btn7">רענון</a>
                                    </div>
                                    <div id="jqxgrid1" style="position:relative;z-index:1;"></div>
                                </div>
                            </div>
                        </div>
                        <h3>היסטוריה</h3>
                        <div id="exp-3" style="padding:0;margin:0">
                            <div class="expander-entry">
                                <div class="grid-wrap rtl">
                                    <div>
                                        <a id="jqxgrid2-add" href="#" class="btn-default btn7">הוסף</a>
                                        <a id="jqxgrid2-refresh" href="#" class="btn-default btn7">רענון</a>
                                    </div>
                                    <div id="jqxgrid2" style="position:relative;z-index:1;"></div>
                                </div>
                            </div>
                        </div>
                        <h3>מעקב זמנים</h3>
                        <div id="exp-4" style="padding:0;margin:0">
                            <div class="expander-entry">
                                <div class="grid-wrap rtl">
                                    <div>
                                        <a id="jqxgrid3-add" href="#" class="btn-default btn7">הוסף</a>
                                        <a id="jqxgrid3-edit" href="#" class="btn-default btn7">עריכה</a>
                                        <a id="jqxgrid3-remove" href="#" class="btn-default btn7">הסרה</a>
                                        <a id="jqxgrid3-refresh" href="#" class="btn-default btn7">רענון</a>
                                    </div>
                                    <div id="jqxgrid3" style="position:relative;z-index:1;"></div>
                                </div>
                            </div>
                        </div>
                        <h3>קבצים</h3>
                        <div id="exp-5" style="padding:0;margin:0">
                            <div class="expander-entry">
                                <div id="task-files">
                                    <iframe id="iframe-files" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>
                                </div>

                                    <div id="jqxWidget" style="margin: 0 auto; display: none; direction: rtl">
                                        <h3 class="rightPan">קבצים</h3>
                                        <div id="splitter">
                                            <div style="overflow: hidden;">
                                                <div style="border: none;" id="MediaList">
                                                </div>
                                            </div>
                                            <div style="overflow: auto;" id="ContentPanel">
                                            </div>
                                        </div>
                                        <div id="uploader">
                                            <div style="width: 250px">
                                                <span>Select files...</span>
                                                <input type="hidden" id="uploadPid" value="" />
                                                <input type="hidden" id="uploadPtype" value="" />
                                                <input type="hidden" id="uploadPath" value="" />
                                                <input type="hidden" id="uploadUuid" value="" />
                                                <div style="padding: 10px">
                                                    <span class="btn btn-success fileinput-button">
                                                        <i class="glyphicon glyphicon-plus"><span>הוספת קובץ</span></i>
                                                        <input id="fileupload" type="file" name="files[]" multiple>
                                                    </span>
                                                    <span id="spnRemove" class="btn btn-success fileinput-button">
                                                        <i class="glyphicon glyphicon-minus"><span>הסרת קובץ</span></i>
                                                        <input id="fileremove" type="button" value="הסרת קובץ" />
                                                    </span>

                                                    <br>
                                                    <div id="progress" class="progress">
                                                        <div class="progress-bar progress-bar-success"></div>
                                                    </div>
                                                    <div id="files" class="files"></div>
                                                </div>
                                                <div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    @*<div class="grid-wrap rtl">
                <div id="jqxgrid4" style="position:relative;z-index:1;"></div>
            </div>*@
                                </div>
                        </div>
                    </div>

                </div>
            </div>   
        </div>
        <div id="wiz-2" class="wiz-tab">
            <div class="rtl">
                <a id="task-item-update" class="btn-default btn7 w-60" href="#">עדכון</a>
                <a id="task-item-cancel" class="btn-default btn7 w-60" href="javascript:goPartial(1);">ביטול</a>
            </div>
            <div id="divPartial2" class="wiz-partial"></div>
        </div>
        <div id="wiz-3" class="wiz-tab">
            <div class="rtl">
                <a class="btn-default btn7 w-60" href="javascript:goPartial(1);">חזרה</a>
            </div>
            <div id="divPartial3"></div>
        </div>
        <div id="wiz-4" class="wiz-tab">
            <h3 class="rtl">מעקב זמנים</h3>
            <div id="divPartial4"></div>
        </div>
        <div id="wiz-5" class="wiz-tab">
            <h3 class="rtl">הערות-עריכה</h3>
            <div id="divPartial5"></div>
        </div>
        <div id="wiz-6" class="wiz-tab">
            <h3 class="rtl">העברה</h3>
            <div id="divPartial6"></div>
        </div>
        <div id="wiz-7" class="wiz-tab">
            <h3 class="rtl">מעקב זמנים - עריכה</h3>
            <div id="divPartial7"></div>
        </div>
    </div>
</div>
<!--end of content-wrapper-->


<script type="text/javascript">
    app_menu.activeLayoutMenu("liSystem");
    app_menu.breadcrumbs("System", "Tasks", 'en');
</script>



