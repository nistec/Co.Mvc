@model Pro.Mvc.Models.UploadFileModel
@{
    Layout = "~/Views/Shared/_ViewMain.cshtml";
    Page.Title = "Sms";
}
@section head {

    @Scripts.Render("~/bundles/jqx")
    @Scripts.Render("~/bundles/jqxgrid")
    <script type="text/javascript" src="~/jqwidgets/jqxdata.export.js"></script>
    <script type="text/javascript" src="~/Scripts/plagins/uploader/js/jquery.iframe-transport.js"></script>
    <script type="text/javascript" src="~/Scripts/plagins/uploader/js/jquery.iframe-transport.js"></script>
    <script type="text/javascript" src="~/Scripts/plagins/uploader/js/jquery.fileupload.js"></script>
    <link type="text/css" href="~/Scripts/plagins/uploader/css/jquery.fileupload.css" rel="stylesheet" />

    <script type="text/javascript" src="~/Scripts/app/dateFormat.js"></script>

<style type="text/css">
    .ui-accordion-header-active {
        background: #15C8D8;
    }
    #accordion {
      direction:rtl;
      width:400px;
      float:right;
    }
    .item {
        margin-right: 5px;
        margin-top: 5px;
        margin-bottom: 10px;
    }
</style>

}

@section scripts {
    <script type="text/javascript">

    $(document).ready(function () {

        $("#accordion").accordion({ heightStyle: "content" });

        $("#btnRefresh").jqxLinkButton({ width: 100, height: 30 });

        @*var doMembersRemove = function (category) {

            app_query.doPost('@Url.Action("ExecRemoveMemmbersCategory", "Media")', "{'category':'" + category + "'}");
        }

        var doUnpayedRemove = function (cat) {

            app_query.doPost('@Url.Action("UnpayedRemove", "Common")', { 'campaign': cat });
        }*@

        $('#btnRemove').click(function () {
            $("#final").html('');


            var cat = $("#Category").val();

            if (!cat || cat <= 0) {
                alert("חובה לציין סיווג");
                return;
            }
            app_dialog.confirm("האם להסיר את כל המנויים מהסיווג שנבחר?",
                 callBack = function (category) {
                        app_query.doPost('@Url.Action("ExecRemoveMemmbersCategory", "Media")', {'category': category });
                }, cat);

                //app_dialog.confirm("האם להסיר את כל המנויים מהסיווג שנבחר?", doMembersRemove, cat);
            });

            $('#btnUnPaied').click(function () {

                $("#final").html('');

                var camp = $("#Campaign").val();

                if (!camp || camp <= 0) {
                    camp = 0;
                }
                app_dialog.confirm("האם להסיר את כל הנרשמים שלא שילמו?",
                    callBack = function (camp) {
                        app_query.doPost('@Url.Action("UnpayedRemove", "Common")', { 'campaign': camp });
                 }, camp);

                //app_dialog.confirm("האם להסיר את כל הנרשמים שלא שילמו?", doUnpayedRemove, cat);

            });


            $('#btnUnPaiedView').click(function () {
                $("#final").html('');
                app_popup.gridView('@Url.Action("_View", "Common")' + '?v=unpayed-grid', "פירוט נרשמים ללא תשלום");
        });


        @*var doRemove = function () {
                $("#final").html('');
                var category = $("#listCategory").val();
                $.ajax({
                    url: '@Url.Action("ExecRemoveMemmbersCategory", "Media")',
                    type: "POST",
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",
                    data: "{'category':'" + category + "'}",
                    success: function (data) {
                        if (data) {
                            if (data.Status < 0)
                                alert(data.Message);
                            else {
                                $("#final").html(data.Message);
                            };
                        }

                    },
                    error: function (jqXHR, status, error) {
                        alert(error);
                    }
                });
            };*@

        @*var categoryAdapter = app_jqxcombos.createComboAdapter("PropId", "PropName", "listCategory", '@Url.Action("GetCategoriesView", "Common")', 200, 120, false);*@
        app_jqx_list.categoryComboAdapter();
        app_jqx_list.campaignComboAdapter();

    });


    </script>

}

<!--breadcrumb-->
<div class="breadcrumbs">
</div>
<div class="top-space"></div>
<div class="global-view">
    <div class="container">
        <div style="height: 50px;text-align:right">
            <a href="javascript:location.reload();" id="btnRefresh">רענון</a>
        </div>
        <div id="accordion">
            <h3>הסרת מנויים מקבוצה</h3>
            <div id="exp-1" style="padding:0;margin:0">
                <div class="expander-entry">

                    <div class="item">
                        <label class="headline">סיווג</label>
                        <br />
                        <div id="Category"></div>
                        <br />
                        <br />
                        <input type="button" id="btnRemove" value="הסרת מנויים מהמאגר הקבוע" />
                    </div>

                </div>
            </div>
            <h3>הסרת נרשמים ללא תשלום</h3>
            <div id="exp-1" style="padding:0;margin:0">
                <div id="divUnPaied" class="expander-entry">
                    <div class="item">
                        <div id="Campaign"></div>
                    </div>
                    <div class="item">
                        
                        <input type="button" id="btnUnPaiedView" value="הצג נרשמים ללא תשלום" />
                    </div>
                    <div class ="item">
                        <input type="button" id="btnUnPaied" value="הסרת נרשמים ללא תשלום מהמאגר הקבוע" />
                    </div>
                   </div>
            </div>
        </div>
        <div style="margin:20px">
            <div id="final" style="text-align:right; font-size:18px"></div>
        </div>
      </div>
</div>

<div class="clear"></div>
<!--end of content-wrapper-->
<script type="text/javascript">
    app_menu.activeLayoutMenu("liMain");
    app_menu.breadcrumbs("Main", "MembersRemove", 'en');
</script>
